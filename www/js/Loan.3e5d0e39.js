(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Loan"],{"0cc7":function(t,e,o){"use strict";o.r(e);var a,n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("page-head",{attrs:{titleKey:"loanTitle",fixed:!0}}),o("div",{staticClass:"loan-formitem"},[o("div",{staticClass:"loan-div"},[o("h3",[t._v(t._s(t.$t("cn-2146")))]),o("b",[t._v(t._s(t.$formatMoney(t.loanAmount))+t._s(t.$t("home-unit")))]),o("van-slider",{attrs:{"bar-height":"6",min:t.step,step:t.step,max:parseFloat(t.formatAmount(t.leftQuota)),"active-color":"#4252D4"},on:{change:t.onChangeLoanAmount},model:{value:t.loanAmount,callback:function(e){t.loanAmount=e},expression:"loanAmount"}}),o("i",{staticClass:"left"},[t._v(t._s(t.step))]),o("i",{staticClass:"right"},[t._v(t._s(t.formatAmount(t.leftQuota)))])],1)]),o("div",{staticClass:"loan-formitem"},[o("div",{staticClass:"loan-div"},[o("h3",[t._v(t._s(t.$t("cn-274")))]),o("div",{staticClass:"loan-term-btn"},t._l(t.productList,(function(e){return o("van-button",{key:e.periodShow,attrs:{type:t.getCellType(e)},on:{click:function(o){return t.selectProduct(e)}}},[t._v(t._s(e.periodShow))])})),1)])]),o("div",{staticClass:"loan-form"},[o("van-cell-group",[o("van-cell",{attrs:{"is-link":"","arrow-direction":t.showPayType?"down":""},on:{click:function(e){t.showPayType=!t.showPayType}},scopedSlots:t._u([{key:"icon",fn:function(){return[o("i",{staticClass:"product-icon"})]},proxy:!0},{key:"title",fn:function(){return[o("p",{staticClass:"product-title"},[o("b",[t._v(t._s(t.payName))]),o("span",[t._v(t._s(t.$t("cn-21471")))])])]},proxy:!0}])}),o("van-cell",{directives:[{name:"show",rawName:"v-show",value:t.showPayType,expression:"showPayType"}],attrs:{"arrow-direction":t.showPayType?"down":""},scopedSlots:t._u([{key:"title",fn:function(){return[o("p",{staticClass:"product-channel-title",on:{click:t.checkChannelType}},[t._v(t._s(t.$t("cn-21472")))])]},proxy:!0},{key:"right-icon",fn:function(){return[o("van-icon",{attrs:{name:t.selectPayChannel?"checked":"circle",size:"22",color:"#495FED"},on:{click:t.checkChannelType}})]},proxy:!0}])})],1)],1),o("div",{staticClass:"loan-form"},[o("van-cell-group",[t.vouCherList.length>0?o("van-cell",{attrs:{"is-link":"",title:t.$t("cn-1063")},on:{click:function(e){t.showVoucher=!0}}},[o("template",{slot:"default"},[t.$isNullOrEmpty(t.voucherGid)?t.unAutoSelect?o("span",{staticStyle:{color:"var(--theme-color)"}},[t._v(t._s(t.$t("cn-1066")))]):o("span",{staticStyle:{color:"#808080"}},[t._v(t._s(t.$t("cn-1067")))]):o("span",{staticStyle:{color:"var(--theme-color)"}},[t._v(t._s(t.$t("cn-1068"))+t._s(t.$formatMoney(t.selectedVoucher.discountAmount))+t._s(t.$t("home-unit")))]),o("span")])],2):t._e()],1)],1),o("div",{staticClass:"loan-form"},[o("van-cell-group",[o("van-cell",{attrs:{title:t.$t("cn-275"),value:t.dueTime}}),o("van-cell",{attrs:{title:t.$t("cn-1038"),value:t.$formatMoney(t.leftAmount)+t.$t("home-unit")}}),t.$isNullOrEmpty(t.discountAmount)?o("van-cell",{attrs:{title:t.$t("cn-277"),value:t.$formatMoney(t.fee)+t.$t("home-unit")}}):o("van-cell",{staticStyle:{color:"#f83d14"},attrs:{title:t.$t("cn-277")}},[o("p",{attrs:{slot:"default"},slot:"default"},[o("span",{staticStyle:{display:"block",color:"#f83d14"}},[t._v(t._s(""+t.$formatMoney(t.fee)+t.$t("home-unit")+" - "+t.$formatMoney(t.discountAmount)+t.$t("home-unit")))]),o("span",{staticStyle:{display:"block",color:"#f83d14"}},[t._v(t._s("= "+t.$formatMoney(t.differenceFee))+t._s(t.$t("home-unit")))])])])],1)],1),o("div",{staticClass:"loan-contract"},[o("van-checkbox",{model:{value:t.isReadContract,callback:function(e){t.isReadContract=e},expression:"isReadContract"}}),t._v(" "+t._s(t.$t("cn-305"))+" "),o("b",{on:{click:function(e){t.showContract(1,t.$t("cn-306"))}}},[t._v("《"+t._s(t.$t("cn-306"))+"》")])],1),o("van-button",{staticClass:"reg-submit",attrs:{type:"info",loading:t.isSubmit,"loading-text":t.$t("cn-1043")},on:{click:t.submitHandle}},[t._v(t._s(t.$t("cn-307")))]),o("van-popup",{style:{paddingTop:"40px",paddingBottom:"45px"},attrs:{position:"bottom",closeable:""},model:{value:t.showSel,callback:function(e){t.showSel=e},expression:"showSel"}},[o("van-radio-group",{model:{value:t.loanDay,callback:function(e){t.loanDay=e},expression:"loanDay"}},[o("van-cell-group",t._l(t.productList,(function(e){return o("van-cell",{key:e.productCode,attrs:{title:e.periodShow,clickable:""},on:{click:function(o){t.loanDay=e.periodShow,t.productCode=e.productCode,t.showSel=!1}}},[o("van-radio",{attrs:{slot:"right-icon",name:e.periodShow},slot:"right-icon"})],1)})),1)],1)],1),o("van-popup",{style:{paddingTop:"40px",paddingBottom:"45px"},attrs:{position:"bottom",closeable:""},model:{value:t.showCar,callback:function(e){t.showCar=e},expression:"showCar"}},[o("van-radio-group",{model:{value:t.carName,callback:function(e){t.carName=e},expression:"carName"}},[o("van-cell-group",t._l(t.bankCardList,(function(e,a){return o("van-cell",{key:a,attrs:{title:e.bankName+"-"+e.cardNo,clickable:""},on:{click:function(o){t.carName=e.bankName+"-"+e.cardNo,t.bankCardGid=e.cardGid,t.showCar=!1}}},[o("van-radio",{attrs:{slot:"right-icon",name:e.bankName+"-"+e.cardNo},on:{click:function(o){t.bankCardGid=e.cardGid}},slot:"right-icon"})],1)})),1)],1)],1),o("van-popup",{style:{height:"80%",minHeight:"30%",paddingTop:"40px",paddingBottom:"60px"},attrs:{position:"bottom",closeable:""},model:{value:t.showVoucher,callback:function(e){t.showVoucher=e},expression:"showVoucher"}},[o("van-radio-group",{staticClass:"voucher-body",model:{value:t.voucherGid,callback:function(e){t.voucherGid=e},expression:"voucherGid"}},t._l(t.vouCherList,(function(e,a){return o("div",{key:a,staticClass:"voucher-item",on:{click:function(e){t.showVoucher=!1}}},[o("div",{class:e.disabled?"voucherItem-used":"voucherItem"},[o("p",{staticClass:"voucherLeft"},[o("b",[t._v(t._s(e.name))]),o("span",{class:e.disabled?"red":""},[t._v(t._s(t.$t("cn-1058"))+t._s(t.$formatMoney(e.loanAmountLimit))+t._s(t.$t("home-unit")))]),o("span",[t._v(t._s(e.startDate)+" - "+t._s(e.endDate)+" "+t._s(t.$t("cn-1059")))])]),o("p",{staticClass:"voucherRight"},[o("b",[t._v(t._s(t.$formatMoney(e.discountAmount))+t._s(t.$t("home-unit")))]),o("span",[t._v(t._s(t.$t("cn-1060")))])])]),e.disabled?t._e():o("div",{staticClass:"voucher-radio"},[o("van-radio",{attrs:{"icon-size":"25","checked-color":"#e40e0e",name:e.discountGid}})],1)])})),0),o("p",{staticClass:"voucher-title"},[t._v(t._s(t.$t("cn-1070")))]),o("van-button",{staticClass:"voucher-nosel",attrs:{type:"info"},on:{click:t.unUseChart}},[t._v(t._s(t.$t("cn-1071")))])],1),o("van-dialog",{attrs:{confirmButtonText:t.$t("cn-434"),cancelButtonText:t.$t("cn-1051"),title:t.contractTitle},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("div",{staticClass:"contract-model",attrs:{id:"contractBody"}},[(t.showContractType,o("p"))])])],1)},i=[],s=(o("99af"),o("7db0"),o("d81d"),o("4e82"),o("b0c0"),o("acd8"),o("ac1f"),o("5319"),o("2fa7")),c=(o("b342"),o("ad06")),r=(o("87d0"),o("e41f")),u=(o("608d"),o("9f14")),l=(o("01bb"),o("e27c")),h=(o("9eda"),o("565f")),d=(o("c625"),o("b650")),m=(o("f811"),o("8ad4")),p=(o("3ec1"),o("7744")),f=(o("2a53"),o("34e9")),v=(o("47e2"),o("2241")),y=(o("9753"),o("417e")),$=(o("6370"),o("3acc")),b=o("a474"),C=(a={},Object(s["a"])(a,$["a"].name,$["a"]),Object(s["a"])(a,y["a"].name,y["a"]),Object(s["a"])(a,v["a"].Component.name,v["a"].Component),Object(s["a"])(a,f["a"].name,f["a"]),Object(s["a"])(a,p["a"].name,p["a"]),Object(s["a"])(a,m["a"].name,m["a"]),Object(s["a"])(a,d["a"].name,d["a"]),Object(s["a"])(a,h["a"].name,h["a"]),Object(s["a"])(a,l["a"].name,l["a"]),Object(s["a"])(a,u["a"].name,u["a"]),Object(s["a"])(a,r["a"].name,r["a"]),Object(s["a"])(a,c["a"].name,c["a"]),a),g={name:"Loan",components:C,props:{},data:function(){return{loanAmount:"0",step:100,loanDay:"",carName:this.$t("cn-1042"),isReadContract:!0,showContractType:"",contractTitle:"",show:!1,showSel:!1,isReport:!1,showVoucher:!1,isSubmit:!1,showCar:!1,showPayChannel:!1,selectPayChannel:!0,showPayType:!0,payType:"",payName:"",channelType:"",channelName:"",payTypeList:[],selectPayItem:[],unAutoSelect:!1,productCode:"",bankCardList:[],vouCherList:[],productList:[],canUsedVoucherList:[],selectedVoucher:{},bankCardGid:"",voucherGid:"",fee:"0",discountAmount:"",differenceFee:"0",dueTime:"",leftAmount:"0",leftQuota:"0",totalQuota:""}},computed:{},watch:{payType:function(){var t=this,e=[];this.payTypeList.map((function(o){t.payType===o.payType&&(e=o.channelList)})),this.selectPayItem=e},channelType:function(){this.onVoucherAndProductChange()},voucherGid:function(){this.$isNullOrEmpty(this.voucherGid)||this.onChersChange(),this.onVoucherAndProductChange()},productCode:function(){this.onVoucherAndProductChange()}},created:function(){var t=this;this.$axios.all([Object(b["y"])({userGid:localStorage.getItem("userGid")}),Object(b["s"])({userGid:localStorage.getItem("userGid")})]).then((function(e){var o=e[0].data,a=e[1].data;"0000"!==e[0].code||"0000"!==e[1].code?t.$toast(e[0].message||e[1].message):(t.productList=a.productList||[],t.productList&&t.productList.length>0&&(t.productCode=t.productList[0].productCode,t.loanDay=t.productList[0].periodShow),t.totalQuota=o.quotaInfo.totalQuota,t.leftQuota=o.quotaInfo.leftQuota,t.payTypeList=o.payTypeList||[],t.payTypeList&&t.payTypeList.length>0&&(t.payType=t.payTypeList[0].payType,t.payName=t.payTypeList[0].payName),t.$nextTick((function(){t.loanAmount=t.formatAmount(o.quotaInfo.leftQuota||"0");var e=o.discountInfoList;t.formatVoucherList(e,t.leftQuota),t.amountHandle()})),t.bankCardList=o.bankCardList),t.uploadContext()}))},mounted:function(){},destroyed:function(){},methods:{checkChannelType:function(){this.selectPayChannel=!this.selectPayChannel},selectProduct:function(t){this.loanDay=t.periodShow,this.productCode=t.productCode},getCellType:function(t){return t.productCode===this.productCode?"info":"default"},onChangeLoanAmount:function(t){this.loanAmount=t,this.amountHandle()},uploadContext:function(){if(!this.$isNullOrEmpty(navigator)&&!this.$isNullOrEmpty(navigator.contacts)){var t=this,e={filter:"",multiple:!0};t.isReport||navigator.contacts.find(["name","displayName","phoneNumbers"],(function(e){for(var o=[],a=0;a<e.length;a++){var n=e[a],i=n.displayName;if(t.$isNullOrEmpty(i)&&n.name)for(var s in n.name)if(i=i||n.name[s],i)break;var c=[],r=e[a].phoneNumbers;if(!t.$isNullOrEmpty(r)&&0!==r.length){for(var u=0;u<r.length;u++)c.push({id:r[u].id||"",label:r[u].label||"",number:r[u].value.replace(/ /g,"")});i&&c.length>0&&o.push({name:i,phoneList:c})}}o.length>0&&Object(b["h"])({userGid:localStorage.getItem("userGid"),contactList:o}).then((function(){t.isReport=!0}))}),(function(){}),e)}},onVoucherAndProductChange:function(){var t=this;if(this.$isNullOrEmpty(this.loanAmount)||!this.$isNumber(this.loanAmount))return this.dueTime="- - ",this.leftAmount="0",this.fee="0",this.discountAmount="",this.voucherGid="",void(this.selectedVoucher={});var e=parseFloat(this.loanAmount);if(e%this.step!==0||e<100)return this.dueTime="- - ",this.leftAmount="0",this.fee="0",this.discountAmount="",this.voucherGid="",void(this.selectedVoucher={});this.$isNullOrEmpty(this.productCode)?this.$toast(this.$t("cn-1041")):Object(b["o"])({userGid:localStorage.getItem("userGid"),loanAmount:this.loanAmount,productCode:this.productCode,payType:this.payType,channelType:this.channelType,discountGid:this.voucherGid}).then((function(e){if("0000"===e.code){var o=e.data;t.dueTime=o.dueTime,t.leftAmount=o.leftAmount,t.fee=o.fee;var a=t.formatAmount(o.discountAmount||"");if(t.$isNullOrEmpty(a)||t.$isNullOrEmpty(t.voucherGid))a="";else{var n=t.formatAmount(o.fee),i=t.accSub(n,a);i<0&&(i="0",a=n),t.differenceFee=i}t.discountAmount=a}else t.$toast(e.message)})).catch((function(){t.$toast(t.$t("cn-1044"))}))},formatAmount:function(t){return t.replace(/[^\d.]/g,"")},formatVoucherList:function(t,e){var o=this;if(this.$isNullOrEmpty(t)||0===t.length)return this.canUsedVoucherList=[],void(this.vouCherList=[]);e=this.formatAmount(e);var a=[],n=[];t.map((function(t){var i=o.$getDateTime(t.endDate);if(t.endDataTimeStem=i,t.startDataTimeStem=o.$getDateTime(t.startDate),"0"===t.useStatus){var s=o.formatAmount(t.loanAmountLimit);parseFloat(s)>parseFloat(e)?(t.pageMsg="最低借款金额大于当前剩余可借额度",t.disabled=!0,n.push(t)):(t.pageMsg="",t.disabled=!1,a.push(t))}})),n.sort((function(t,e){return t.endDataTimeStem-e.endDataTimeStem})),a.sort((function(t,e){return t.endDataTimeStem-e.endDataTimeStem})),n.sort((function(t,e){return o.$preFormatMoney(e.discountAmount)-o.$preFormatMoney(t.discountAmount)})),a.sort((function(t,e){return o.$preFormatMoney(e.discountAmount)-o.$preFormatMoney(t.discountAmount)})),this.canUsedVoucherList=a,this.vouCherList=a.concat(n)},getBestVoucher:function(t){var e=this;if(this.unAutoSelect||this.$isNullOrEmpty(t))return"";t=parseFloat(t);var o=null;return this.canUsedVoucherList.map((function(a){var n=e.formatAmount(a.loanAmountLimit);e.$isNullOrEmpty(o)&&t>=parseFloat(n)&&(o=a)})),this.$isNullOrEmpty(o)?(this.voucherGid="",this.selectedVoucher={}):(this.voucherGid=o.discountGid,this.selectedVoucher=o),this.voucherGid},onChersChange:function(){var t=this,e=this.vouCherList;e.map((function(e){if(e.discountGid===t.voucherGid){t.selectedVoucher=e,t.unAutoSelect=!1;var o=t.formatAmount(e.loanAmountLimit||"0");t.loanAmount=parseFloat(o)>parseFloat(t.loanAmount)?o:t.loanAmount,t.amountHandle(e.discountGid)}}))},unUseChart:function(){this.showVoucher=!1,this.voucherGid="",this.unAutoSelect=!0},showContract:function(t,e){this.showContractType=t,this.contractTitle=e,this.show=!0,this.$nextTick((function(){document.getElementById("contractBody").scrollTo(0,0)}))},submitHandle:function(){var t=this;if(!this.isSubmit){if(this.isSubmit=!0,!this.isReadContract)return this.$toast(this.$t("cn-1040")),void(this.isSubmit=!1);if(this.$isNullOrEmpty(this.loanAmount)||!this.$isNumber(this.loanAmount))return this.$toast(this.$t("cn-1037")),void(this.isSubmit=!1);var e=parseFloat(this.loanAmount);return e%this.step!==0||e<100?(this.$toast(this.$t("cn-1039")),void(this.isSubmit=!1)):this.$isNullOrEmpty(this.productCode)?(this.$toast(this.$t("cn-1041")),void(this.isSubmit=!1)):this.selectPayChannel?!this.$isNullOrEmpty(this.voucherGid)&&e<parseFloat(this.selectedVoucher.loanAmountLimit)?(this.$toast(this.$t("cn-1072")),void(this.isSubmit=!1)):this.$isNullOrEmpty(this.fee)||0===parseFloat(this.fee)?(this.$toast(this.$t("cn-10441")),void(this.isSubmit=!1)):void Object(b["n"])({userGid:localStorage.getItem("userGid"),loanAmount:this.loanAmount,productCode:this.productCode,cardGid:this.bankCardGid,payType:this.payType,channelType:this.channelType,discountGid:this.voucherGid}).then((function(e){if("0000"===e.code){var o=e.data;t.$router.replace({path:"/loanResult",query:{orderId:o.orderId}})}else t.$toast(e.message),t.isSubmit=!1})).catch((function(){t.$toast(t.$t("cn-1044")),t.isSubmit=!1})):(this.$toast(this.$t("cn-2149")),void(this.isSubmit=!1))}},amountHandle:function(t){var e=this;if(this.$isNullOrEmpty(this.loanAmount)||!this.$isNumber(this.loanAmount))return this.dueTime="- - ",this.leftAmount="0",this.fee="0",this.discountAmount="",this.voucherGid="",void(this.selectedVoucher={});var o=parseFloat(this.loanAmount);if(o%this.step!==0||o<100)return this.dueTime="- - ",this.leftAmount="0",this.fee="0",this.discountAmount="",this.voucherGid="",void(this.selectedVoucher={});if(this.$isNullOrEmpty(this.productCode))this.$toast(this.$t("cn-1041"));else{var a=this.$isNullOrEmpty(t)?this.getBestVoucher(o):t;Object(b["o"])({userGid:localStorage.getItem("userGid"),loanAmount:this.loanAmount,productCode:this.productCode,payType:this.payType,channelType:this.channelType,discountGid:a}).then((function(t){if("0000"===t.code){var o=t.data;e.dueTime=o.dueTime,e.leftAmount=o.leftAmount,e.fee="".concat(o.fee);var n=e.formatAmount(o.discountAmount||"");if(e.$isNullOrEmpty(a)||e.$isNullOrEmpty(n))n="";else{var i=e.formatAmount(o.fee),s=e.accSub(i,n);s<0&&(s="0",n=i),e.differenceFee=s}e.discountAmount=n}else e.$toast(t.message)})).catch((function(){e.$toast(e.$t("cn-1044"))}))}}}},A=g,T=(o("9384"),o("6e58"),o("2877")),_=Object(T["a"])(A,n,i,!1,null,"a9348670",null);e["default"]=_.exports},"6e58":function(t,e,o){"use strict";var a=o("eb5a"),n=o.n(a);n.a},9384:function(t,e,o){"use strict";var a=o("c304"),n=o.n(a);n.a},c304:function(t,e,o){},eb5a:function(t,e,o){}}]);